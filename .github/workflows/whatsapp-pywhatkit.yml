name: WhatsApp via PyWhatKit (Web WhatsApp)

on:
  workflow_dispatch: # Manual only - requires browser automation

jobs:
  send-whatsapp-pywhatkit:
    runs-on: ubuntu-latest
    steps:
      - name: Setup Python and Dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y python3-pip xvfb firefox-esr
          pip3 install pywhatkit selenium webdriver-manager
      
      - name: Send WhatsApp Message
        run: |
          python3 << 'EOF'
          import pywhatkit as pwk
          from datetime import datetime, timedelta
          import time
          
          # Calculate time 2 minutes from now
          now = datetime.now()
          send_time = now + timedelta(minutes=2)
          
          phone_number = "+917528940605"
          message = f"🌅 Good morning! {now.strftime('%A, %B %d, %Y')} - Your daily PyWhatKit reminder! 💪"
          
          try:
              # This opens WhatsApp Web and sends message
              pwk.sendwhatmsg(phone_number, message, send_time.hour, send_time.minute)
              print("✅ Message scheduled successfully!")
          except Exception as e:
              print(f"❌ Error: {e}")
          EOF